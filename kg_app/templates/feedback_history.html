{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description"
    content="Admiro admin is super flexible, powerful, clean &amp; modern responsive bootstrap 5 admin template with unlimited possibilities.">
  <meta name="keywords"
    content="admin template, Admiro admin template, best javascript admin, dashboard template, bootstrap admin template, responsive admin template, web app">
  <meta name="author" content="pixelstrap">
  <title>Feedback History</title>
  <!-- Favicon icon-->
  <link rel="icon" href="{% static 'assets/img/favicon.png' %}" type="image/x-icon">
  <link rel="shortcut icon" href="{% static 'assets/img/favicon.png' %}" type="image/x-icon">
  <!-- Google font-->
  <link rel="preconnect" href="https://fonts.googleapis.com">

  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
  <link
    href="../../css2?family=Nunito+Sans:opsz,wght@6..12,200;6..12,300;6..12,400;6..12,500;6..12,600;6..12,700;6..12,800;6..12,900;6..12,1000&amp;display=swap"
    rel="stylesheet">
  <!-- Flag icon css -->
  <link rel="stylesheet" href="{% static 'assets/css/vendors/flag-icon.css' %}">
  <!-- iconly-icon-->
  <link rel="stylesheet" href="{% static 'assets/css/iconly-icon.css' %}">
  <link rel="stylesheet" href="{% static 'assets/css/bulk-style.css' %}">
  <!-- iconly-icon-->
  <link rel="stylesheet" href="{% static 'assets/css/themify.css' %}">
  <!--fontawesome-->
  <link rel="stylesheet" href="{% static 'assets/css/fontawesome-min.css' %}">
  <!-- Whether Icon css-->
  <link rel="stylesheet" type="text/css" href="{% static 'assets/css/vendors/weather-icons/weather-icons.min.css' %}">
  <link rel="stylesheet" type="text/css" href="{% static 'assets/css/vendors/scrollbar.css' %}">
  <link rel="stylesheet" type="text/css" href="{% static 'assets/css/vendors/slick.css' %}">
  <link rel="stylesheet" type="text/css" href="{% static 'assets/css/vendors/slick-theme.css' %}">
  <link rel="stylesheet" type="text/css" href="{% static 'assets/css/vendors/datatables.css' %}">
  <link rel="stylesheet" type="text/css" href="{% static 'assets/css/vendors/datatable-extension.css' %}">
  <!-- App css -->
  <link id="color" rel="stylesheet" href="{% static 'assets/css/color-1.css' %}" media="screen">
  <link rel="stylesheet" href="{% static 'assets/css/style.css' %}">



  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"
    integrity="sha512-…(hash)…”" crossorigin=" anonymous" referrerpolicy="no-referrer" />

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"
    integrity="sha512-…(hash)…”" crossorigin=" anonymous" referrerpolicy="no-referrer" />

  <link rel="stylesheet" href="https://cdn.iconly.io/iconly.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/iconly@latest/css/iconly.css" />

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"
    integrity="sha512-KNuNk+LZ8e2j+ozhRtX7sMGu0j1qFeIslMo7k3M5lVZhcN7sVbG7ByAzt+BrgrbM5nxp7/ECYtJ8O5E2+8Y0eA=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />


  <link rel="stylesheet" href="https://cdn.iconly.io/your-generated-hash/iconly.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>




  <style>
    /*.dataTables_length{
      display : none;
    }*/
    
    .sidebar-pannle-main {
      display: none;
    }

    .margin_left_auto {
      margin-left: auto;
    }

    .glass-btn {
      padding: 12px 24px;
      background: rgba(40, 167, 69, 0.15);
      border: 1px solid rgba(40, 167, 69, 0.3);
      backdrop-filter: blur(10px);
      color: #28a745;
      border-radius: 15px;
      font-weight: 600;
      cursor: pointer;
      transition: 0.3s;
    }

    .glass-btn:hover {
      background: rgba(40, 167, 69, 0.25);
      transform: translateY(-2px);
    }

    .download-btn-wrapper {
      display: flex;
      justify-content: flex-end;
      /* move to right */
      margin-bottom: 10px;
      /* spacing from table */
    }

    #basic-9 {
      width: auto !important;
      table-layout: auto;
    }

    #basic-9 th,
    #basic-9 td {
      white-space: nowrap;
      padding: 8px 12px;
    }

    #basic-9 {
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
    }
  </style>

</head>





<body>
  <!-- page-wrapper Start-->
  <!-- tap on top starts-->
  <div class="tap-top">
    <i class="fa-solid fa-angle-up"></i>
  </div>
  <!-- tap on tap ends-->
  <!-- loader-->
  <div class="loader-wrapper">
    <div class="loader"><span></span><span></span><span></span><span></span><span></span></div>
  </div>


  <div class="page-wrapper compact-wrapper" id="pageWrapper">

    <!-- this is header section -->
    {% include "common/header.html"%}
    <!--header section end -->





    <!-- Page Body Start-->
    <div class="page-body-wrapper">
      <!-- Page sidebar start-->
      {% include "common/sidebar.html"%}
      <!-- Page sidebar end-->

      <!-- body section start  -->
      <div class="page-body">
        <div class="container-fluid">
          <div class="page-title">
            <div class="row">
              <!-- table start -->
              <div class="col-sm-12">
                <div class="card">
                  <div class="card-header pb-0 card-no-border">
                    <h3>Feedback History</h3>
                  </div>
                  <div class="card-body">
                    <div class="download-btn-wrapper">
                      <button id="downloadExcel" class="glass-btn">
                        Download Excel
                      </button>
                    </div>
                    <div class="table-responsive">
                      <table class="display dataTable" id="basic-9">
                        <thead style="background:#f8f9fa;">
                          <tr>
                            <th>Sl</th>
                            <th>Updated By</th>
                            <th>Updated Date</th>
                            <th>Agreement Id</th>
                            <th>Code</th>
                            <th>New Mobile Number</th>
                            <th>Projection</th>
                            <th>Promise Date</th>
                            <th>Promise Amount</th>
                            <th>Customer Remark</th>
                            <th>Reference Remark</th>
                            <th>Need Group Visit</th>
                            <th>Visit Projection</th>
                            <th>Visit Status</th>
                            <th>Customer Available</th>
                            <th>Vehicle Available</th>
                            <th>3rd Party Status</th>
                            <th>3rd Party Details</th>
                            <th>New Updated Address</th>
                            <!-- <th>Location Photo</th> -->
                            <th>Location Status</th>
                            <th>Payment Info</th>
                            <th>Payment Mode</th>
                            <th>Payment Amount</th>
                            <th>Payment Date</th>
                          </tr>
                        </thead>
                        <!-- <tbody id="table-body"> -->
                        <tbody>
                          {% for data in feedback %}
                          <tr>
                            <td>{{forloop.counter}}</td>
                            <td>{{data.updated_by|capfirst }}</td>
                            <td>{{data.updated_at}}</td>
                            <td>{{data.agreement_id}}</td>
                            <td>{{data.code}}</td>
                            <td>{{data.new_mobile_number}}</td>
                            <td>{{data.projection}}</td>
                            <td>{{ data.promise_date|date:"d-m-Y h:i A"}}</td>
                            <td>{{data.promise_amount}}</td>
                            <td>{{data.customer_remark}}</td>
                            <td>{{data.reference_remark}}</td>
                            <td>{{data.need_group_visit}}</td>
                            <td>{{data.visit_projection}}</td>
                            <td>{{data.visit_status}}</td>
                            <td>{{data.customer_available}}</td>
                            <td>{{data.vehicle_available}}</td>
                            <td>{{data.third_party_status}}</td>
                            <td>{{data.third_party_details}}</td>
                            <td>{{data.new_update_address}}</td>
                            <!-- <td>{{data.location_image}}</td> -->
                            <td>{{data.location_status}}</td>
                            <td>{{data.payment_info}}</td>
                            <td>{{data.payment_mode}}</td>
                            <td>{{data.payment_amount}}</td>
                            <td>{{data.payment_date|date:"d-m-Y h:i A"}}</td>
                          </tr>
                          {% endfor %}
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </div>

            </div>
          </div>
        </div>
      </div>
      <!-- Container-fluid starts-->
      {% include "common/footer.html"%}
    </div>
    <!-- page body end  -->

  </div>




  <!-- jquery-->
  <script src="{% static 'assets/js/vendors/jquery/jquery.min.js' %}"></script>
  <!-- bootstrap js-->
  <script src="{% static 'assets/js/vendors/bootstrap/dist/js/bootstrap.bundle.min.js' %}" defer=""></script>
  <script src="{% static 'assets/js/vendors/bootstrap/dist/js/popper.min.js' %}" defer=""></script>
  <!--fontawesome-->
  <script src="{% static 'assets/js/vendors/font-awesome/fontawesome-min.js' %}"></script>
  <!-- feather-->
  <script src="{% static 'assets/js/vendors/feather-icon/feather.min.js' %}"></script>
  <script src="{% static 'assets/js/vendors/feather-icon/custom-script.js' %}"></script>
  <!-- sidebar -->
  <script src="{% static 'assets/js/sidebar.js' %}"></script>
  <!-- height_equal-->
  <script src="{% static 'assets/js/height-equal.js' %}"></script>
  <!-- config-->
  <script src="{% static 'assets/js/config.js' %}"></script>
  <!-- apex-->
  <script src="{% static 'assets/js/chart/apex-chart/apex-chart.js' %}"></script>
  <script src="{% static 'assets/js/chart/apex-chart/stock-prices.js' %}"></script>
  <!-- scrollbar-->
  <script src="{% static 'assets/js/scrollbar/simplebar.js' %}"></script>
  <script src="{% static 'assets/js/scrollbar/custom.js' %}"></script>
  <!-- slick-->
  <script src="{% static 'assets/js/slick/slick.min.js' %}"></script>
  <script src="{% static 'assets/js/slick/slick.js' %}"></script>
  <!-- data_table-->
  <script src="{% static 'assets/js/js-datatables/datatables/jquery.dataTables.min.js' %}"></script>
  <!-- page_datatable-->
  <script src="{% static 'assets/js/js-datatables/datatables/datatable.custom.js' %}"></script>
  <!-- page_datatable1-->
  <script src="{% static 'assets/js/js-datatables/datatables/datatable.custom1.js' %}"></script>
  <!-- page_datatable-->
  <script src="{% static 'assets/js/datatable/datatables/datatable.custom.js' %}"></script>
  <!-- theme_customizer-->
  <script src="{% static 'assets/js/theme-customizer/customizer.js' %}"></script>
  <!-- tilt-->
  <script src="{% static 'assets/js/animation/tilt/tilt.jquery.js' %}"></script>
  <!-- page_tilt-->
  <script src="{% static 'assets/js/animation/tilt/tilt-custom.js' %}"></script>
  <!-- dashboard_1-->
  <script src="{% static 'assets/js/dashboard/dashboard_1.js' %}"></script>


  <!-- slick-->
  <script src="{% static 'assets/js/slick/slick.min.js' %}"></script>
  <script src="{% static 'assets/js/slick/slick.js' %}"></script>
  <!-- datatable-->
  <script src="{% static 'assets/js/datatable/datatables/jquery.dataTables.min.js' %}"></script>
  <!-- datatable_extension-->
  <script src="{% static 'assets/js/datatable/datatable-extension/dataTables.buttons.min.js' %}"></script>
  <script src="{% static 'assets/js/datatable/datatable-extension/jszip.min.js' %}"></script>
  <script src="{% static 'assets/js/datatable/datatable-extension/buttons.colVis.min.js' %}"></script>
  <script src="{% static 'assets/js/datatable/datatable-extension/pdfmake.min.js' %}"></script>
  <script src="{% static 'assets/js/datatable/datatable-extension/vfs_fonts.js' %}"></script>
  <script src="{% static 'assets/js/datatable/datatable-extension/dataTables.autoFill.min.js' %}"></script>
  <script src="{% static 'assets/js/datatable/datatable-extension/dataTables.select.min.js' %}"></script>
  <script src="{% static 'assets/js/datatable/datatable-extension/buttons.bootstrap4.min.js' %}"></script>
  <script src="{% static 'assets/js/datatable/datatable-extension/buttons.html5.min.js' %}"></script>
  <script src="{% static 'assets/js/datatable/datatable-extension/buttons.print.min.js' %}"></script>
  <script src="{% static 'assets/js/datatable/datatable-extension/dataTables.bootstrap4.min.js' %}"></script>
  <script src="{% static 'assets/js/datatable/datatable-extension/dataTables.responsive.min.js' %}"></script>
  <script src="{% static 'assets/js/datatable/datatable-extension/responsive.bootstrap4.min.js' %}"></script>
  <script src="{% static 'assets/js/datatable/datatable-extension/dataTables.keyTable.min.js' %}"></script>
  <script src="{% static 'assets/js/datatable/datatable-extension/dataTables.colReorder.min.js' %}"></script>
  <script src="{% static 'assets/js/datatable/datatable-extension/dataTables.fixedHeader.min.js' %}"></script>
  <script src="{% static 'assets/js/datatable/datatable-extension/dataTables.rowReorder.min.js' %}"></script>
  <script src="{% static 'assets/js/datatable/datatable-extension/dataTables.scroller.min.js' %}"></script>
  <script src="{% static 'assets/js/datatable/datatable-extension/custom.js' %}"></script>

  <!-- datatable-->
  <script src="{% static 'assets/js/datatable/datatables/jquery.dataTables.min.js' %}"></script>
  <!-- page_datatable -->
  <script src="{% static 'assets/js/js-datatables/datatables/datatable.custom.js' %}"></script>
  <!-- page_datatable-->
  <!-- <script src="{% static 'assets/js/datatable/datatables/datatable.custom.js' %}"></script> -->
  <!-- theme_customizer-->
  <script src="{% static 'assets/js/theme-customizer/customizer.js' %}"></script>

  <!-- custom script -->
  <script src="{% static 'assets/js/script.js' %}"></script>


  <script>

    $(document).ready(function() {
        // Destroy existing DataTable if it exists, then reinitialize
        if ($.fn.DataTable.isDataTable('#basic-9')) {
            $('#basic-9').DataTable().destroy();
        }
        
        $('#basic-9').DataTable({
            paging: false,
        });
    });

    document.getElementById('downloadExcel').addEventListener('click', function () {
      // Get the table
      const table = document.getElementById('basic-9');

      // Convert table to workbook
      const wb = XLSX.utils.table_to_book(table, { sheet: "Feedback Data" });

      // Generate filename with current date
      const date = new Date();
      const filename = `feedback_data_${date.getFullYear()}-${(date.getMonth() + 1).toString().padStart(2, '0')}-${date.getDate().toString().padStart(2, '0')}.xlsx`;

      // Download the file
      XLSX.writeFile(wb, filename);
    });
  </script>


  <script>
    const customers = [
      { sl: 1, agreementId: "AG1031", customerName: "Aarav Nanda", mobile: "9845123476", email: "aarav.nanda@example.com", address: "Cuttack, Odisha", telecallerName: "Tanvi Behera", teamleadName: "Rupali Mohanty", groundStaffName: "Sourav Patra", status: "Active" },
      { sl: 2, agreementId: "AG1032", customerName: "Ishita Reddy", mobile: "9812312345", email: "ishita.reddy@example.com", address: "Bhubaneswar, Odisha", telecallerName: "Amit Nayak", teamleadName: "Sujata Sethi", groundStaffName: "Bikram Dash", status: "Pending" },
      { sl: 3, agreementId: "AG1033", customerName: "Karan Sahu", mobile: "9765432155", email: "karan.sahu@example.com", address: "Rourkela, Odisha", telecallerName: "Neha Rout", teamleadName: "Rajesh Patnaik", groundStaffName: "Chandan Behera", status: "Completed" },
      { sl: 4, agreementId: "AG1034", customerName: "Mitali Mohanty", mobile: "9834021198", email: "mitali.mohanty@example.com", address: "Balasore, Odisha", telecallerName: "Tapan Sen", teamleadName: "Sneha Pradhan", groundStaffName: "Hari Nayak", status: "Follow-up" },
      { sl: 5, agreementId: "AG1035", customerName: "Vivek Kumar", mobile: "9876543201", email: "vivek.kumar@example.com", address: "Berhampur, Odisha", telecallerName: "Sasmita Patra", teamleadName: "Abhinav Das", groundStaffName: "Madhusudan Reddy", status: "Active" },
      { sl: 6, agreementId: "AG1036", customerName: "Nikita Sethi", mobile: "9812003456", email: "nikita.sethi@example.com", address: "Angul, Odisha", telecallerName: "Lalit Swain", teamleadName: "Sunil Mohanty", groundStaffName: "Rakesh Nayak", status: "Completed" },
      { sl: 7, agreementId: "AG1037", customerName: "Akhil Patra", mobile: "9823456712", email: "akhil.patra@example.com", address: "Sambalpur, Odisha", telecallerName: "Manisha Das", teamleadName: "Rohit Sen", groundStaffName: "Prakash Rout", status: "Pending" },
      { sl: 8, agreementId: "AG1038", customerName: "Shruti Nayak", mobile: "9877612345", email: "shruti.nayak@example.com", address: "Puri, Odisha", telecallerName: "Niharika Behera", teamleadName: "Madan Dash", groundStaffName: "Tapan Kumar", status: "Follow-up" },
      { sl: 9, agreementId: "AG1039", customerName: "Rohit Swain", mobile: "9900112233", email: "rohit.swain@example.com", address: "Jharsuguda, Odisha", telecallerName: "Sushmita Rani", teamleadName: "Dilip Mohanty", groundStaffName: "Bijay Patra", status: "Active" },
      { sl: 10, agreementId: "AG1040", customerName: "Anjali Das", mobile: "9812349087", email: "anjali.das@example.com", address: "Bhubaneswar, Odisha", telecallerName: "Rahul Behera", teamleadName: "Kalyani Patnaik", groundStaffName: "Jitesh Reddy", status: "Completed" },
      { sl: 11, agreementId: "AG1041", customerName: "Sanjay Mohapatra", mobile: "9867543210", email: "sanjay.mohapatra@example.com", address: "Khurda, Odisha", telecallerName: "Lopamudra Nanda", teamleadName: "Ankit Nayak", groundStaffName: "Harish Sen", status: "Pending" },
      { sl: 12, agreementId: "AG1042", customerName: "Kritika Patnaik", mobile: "9822009988", email: "kritika.patnaik@example.com", address: "Balangir, Odisha", telecallerName: "Manoj Rout", teamleadName: "Pallavi Sahu", groundStaffName: "Debasis Behera", status: "Follow-up" },
      { sl: 13, agreementId: "AG1043", customerName: "Ramesh Swain", mobile: "9890022344", email: "ramesh.swain@example.com", address: "Cuttack, Odisha", telecallerName: "Sujata Patra", teamleadName: "Ritesh Das", groundStaffName: "Kishore Sen", status: "Active" },
      { sl: 14, agreementId: "AG1044", customerName: "Poonam Rani", mobile: "9911445566", email: "poonam.rani@example.com", address: "Berhampur, Odisha", telecallerName: "Anurag Nayak", teamleadName: "Snehal Patnaik", groundStaffName: "Rohit Reddy", status: "Pending" },
      { sl: 15, agreementId: "AG1045", customerName: "Deepak Sethi", mobile: "9887650011", email: "deepak.sethi@example.com", address: "Sambalpur, Odisha", telecallerName: "Ritika Behera", teamleadName: "Manas Sen", groundStaffName: "Gopal Patnaik", status: "Completed" }
    ];




    const tbody = document.getElementById("table-body");

    customers.forEach(emp => {

      //const parts = emp.joining.split('/'); // [yyyy, mm, dd]
      //const formattedDate = `${parts[2]}/${parts[1]}/${parts[0]}`;

      tbody.innerHTML += `
      <tr>
        <td>${emp.sl}</td>
        <td>${emp.agreementId}</td>
        <td>${emp.customerName}</td>
        <td>${emp.mobile}</td>
        <td>${emp.email}</td>
        <td>${emp.address}</td>
        <td>${emp.telecallerName}</td>
        <td>${emp.teamleadName}</td>
        <td>${emp.groundStaffName}</td>
        <td>${emp.status}</td>

       
      </tr>`;
    });
  </script>

</body>

</html>